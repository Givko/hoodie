# This workflow will build a golang project
name: Go

on: [push]

jobs:

  build:
    runs-on: ubuntu-latest
    strategy: 
      matrix:
        go-version: [ '1.19', '1.20', '1.21.x', '1.23.x' ]
    steps:
    - uses: actions/checkout@v4a
    - name: Set up Go
      uses: actions/setup-go@v5
      with:
        go-version: ${{ matrix.go-version }}
    - name: Install dependecies
      run: go get .  
    - name: Build
      run: go build -v ./...

     # Alternatively, install using go install
    - name: Set up gotestfmt
      run: go install github.com/gotesttools/gotestfmt/v2/cmd/gotestfmt@latest

  # Run tests with nice formatting. Save the original log in /tmp/gotest.log
    - name: Run tests
      run: |
        set -euo pipefail
        go test -json -v ./... 2>&1 | tee /tmp/gotest.log | gotestfmt
